---
title: "Talks"
echo: false
toc: false
---

```{r}
#| results: asis
library(tidyverse)
library(htmltools)
library(commonmark)

talks_data <- read_csv("talks/talks.csv")

# Function to convert markdown to HTML
render_markdown <- function(text) {
  HTML(markdown_html(text))
}

# Functions to construct paths
make_slides_path <- function(name) {
  paste0("https://pingfan-hu.github.io/", name, "/")
}

make_pdf_path <- function(name) {
  paste0(file.path("/talks", name), ".pdf")
}

# Create presentations using HTML tags
presentations <- talks_data %>%
  pmap(function(Date, Title, Event, Location, Name, Type = "slide") {
    # Default to "slide" if Type is not provided
    presentation_type <- if(is.null(Type) || is.na(Type)) "slide" else tolower(Type)
    
    div(
      class = "presentation-box",
      div(
        class = "presentation-content",
        div(class = "presentation-title", Title),
        div(
          class = "presentation-details",
          div(class = "event-location", render_markdown(Event)),
          div(class = "presentation-date", format(Date, "%B %d, %Y"))
        )
      ),
      div(
        class = "presentation-icons",
        # Conditionally render either Slides button or Poster text
        if(presentation_type == "slide") {
          a(
            href = make_slides_path(Name),
            class = "presentation-button",
            target = "_blank",
            rel = "noopener noreferrer",
            tags$i(class = "bi bi-file-earmark-slides"),
            span("Slides")
          )
        } else {
          # Simple centered text for Poster
          div(
            style = "text-align: center; width: 100px; margin-right: 0.5rem;",
            tags$i(class = "bi bi-easel"),
            span("Poster")
          )
        },
        # Always show PDF button
        a(
          href = make_pdf_path(Name),
          class = "presentation-button",
          target = "_blank",
          rel = "noopener noreferrer",
          tags$i(class = "bi bi-file-earmark-pdf"),
          span("PDF")
        )
      )
    )
  })

# Render all presentations
div(class = "presentations-container", presentations)
```
